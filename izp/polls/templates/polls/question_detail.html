{% extends 'polls/base.html' %}
{% block content %}
   <h1>{{ question.question_text }}</h1>
   <div class="row">
      <div class="col-sm-3 container-fluid">
         <form action="{% url 'polls:vote' question.id %}" method="post">
         {% csrf_token %}
            {% for choice in question.choice_set.all %}
            <div class="radio">
               <label><input id="{{ choice.id }}" type="radio"
                             name="choice" value="{{ choice.id }}">
                   {{ choice.choice_text}}
               </label>
             </div>
            {% endfor %}
            {% if is_open %}
            <div class="form-group">
               <label for="new_choice">
                   Własna propozycja:
               </label>
               <input id="new_choice" name="new_choice"
                      type="text" class="form-control">
            </div>
            {% endif %}
            {% if is_session %}
            <button class="btn btn-primary">Głosuj</button>
            {% endif %}
         </form>
      </div>
   </div>
   <div class="row">
      <div class="container-fluid top2">
         {% if form %}
         <h3>Nowy komentarz</h3>
         <form method="POST" class="post-form"
               action="{% url 'polls:add_comment_to_question' question.id %}">{% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="save btn btn-default">Dodaj komentarz</button>
         </form>
         {% else %}
         <p>Dodawanie komentarzy możliwe tylko przed rozpoczęciem głosowania</p>
         {% endif %}
      </div>
      <div class="container-fluid top2">
         {% for row in comments %}
         <div class="comment">
            <div class="date"><strong>{{ row.comment.date }}</strong></div>
            <p>{{ row.comment.text|linebreaks }}</p>
            {% if user.is_superuser %}
            <div class="container-fluid bottom1">
            <a class="btn btn-default" href="{% url 'polls:response_to_comment' question.id row.comment.id %}">
               Odpowiedz
            </a>
            </div>
            {% endif %}
            <div class="row container-fluid">
               <div class="left2">
                  {% for response in row.response %}
                  <div class="date"><strong>{{ response.date }}</strong></div>
                  <p>{{ response.text|linebreaks }}</p>
                  {% endfor %}
               </div>
            </div>
         </div>
         {% empty %}
            <p>Brak komentarzy</p>
         {% endfor %}
      </div>
   </div>
{% endblock %}
